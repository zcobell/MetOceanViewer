#!/bin/bash

stationList=( '21413'   '21414'   '21415'   '21416'   '21417'  '21418'  '21419'   '32301'\
              '32302'   '32411'   '32412'   '32413'   '32745'  '32746'  '41001'   '41002'\
              '41003'   '41004'   '41005'   '41006'   '41007'  '41008'  '41009'   '41010'\
              '41011'   '41012'   '41013'   '41015'   '41016'  '41017'  '41018'   '41021'\
              '41022'   '41023'   '41025'   '41035'   '41036'  '41040'  '41041'   '41043'\
              '41044'   '41046'   '41047'   '41048'   '41049'  '41420'  '41421'   '41424'\
              '41425'   '41A46'   '41B41'   '41S43'   '41S46'  '42001'  '42002'   '42003'\
              '42004'   '42005'   '42006'   '42007'   '42008'  '42009'  '42010'   '42011'\
              '42012'   '42015'   '42016'   '42017'   '42018'  '42019'  '42020'   '42025'\
              '42035'   '42036'   '42037'   '42038'   '42039'  '42040'  '42041'   '42042'\
              '42053'   '42054'   '42055'   '42056'   '42057'  '42058'  '42059'   '42060'\
              '42065'   '42080'   '42407'   '42408'   '42409'  '42429'  '42534'   '43412'\
              '43413'   '44001'   '44003'   '44004'   '44005'  '44006'  '44007'   '44008'\
              '44009'   '44010'   '44011'   '44012'   '44013'  '44014'  '44015'   '44017'\
              '44018'   '44019'   '44020'   '44023'   '44025'  '44026'  '44027'   '44028'\
              '44065'   '44066'   '44070'   '44071'   '44401'  '44402'  '44585'   '45001'\
              '45002'   '45003'   '45004'   '45005'   '45006'  '45007'  '45008'   '45009'\
              '45010'   '45011'   '45012'   '46001'   '46002'  '46003'  '46005'   '46006'\
              '46007'   '46008'   '46009'   '46010'   '46011'  '46012'  '46013'   '46014'\
              '46015'   '46016'   '46017'   '46018'   '46019'  '46020'  '46021'   '46022'\
              '46023'   '46024'   '46025'   '46026'   '46027'  '46028'  '46029'   '46030'\
              '46031'   '46032'   '46033'   '46034'   '46035'  '46037'  '46038'   '46039'\
              '46040'   '46041'   '46042'   '46043'   '46045'  '46047'  '46048'   '46050'\
              '46051'   '46053'   '46054'   '46059'   '46060'  '46061'  '46062'   '46063'\
              '46066'   '46069'   '46070'   '46071'   '46072'  '46073'  '46075'   '46076'\
              '46077'   '46078'   '46079'   '46080'   '46081'  '46082'  '46083'   '46084'\
              '46085'   '46086'   '46087'   '46088'   '46089'  '46090'  '46105'   '46106'\
              '46107'   '46115'   '46270'   '46290'   '46401'  '46402'  '46403'   '46404'\
              '46405'   '46406'   '46407'   '46408'   '46409'  '46410'  '46411'   '46412'\
              '46413'   '46414'   '46415'   '46419'   '46490'  '46551'  '46553'   '46779'\
              '46780'   '46781'   '46782'   '46785'   '46B35'  '48011'  '51000'   '51001'\
              '51002'   '51003'   '51004'   '51005'   '51026'  '51027'  '51028'   '51100'\
              '51101'   '51406'   '51407'   '51425'   '51426'  '51542'  '52009'   '52401'\
              '52402'   '52403'   '52404'   '52405'   '52406'  '54401'  '91204'   '91222'\
              '91251'   '91328'   '91338'   '91343'   '91352'  '91355'  '91356'   '91365'\
              '91374'   '91377'   '91411'   '91442'   'ABAN6'  'ALRF1'  'ALSN6'   'AMAA2'\
              'AUGA2'   'BLIA2'   'BURL1'   'BUSL1'   'BUZM3'  'CARO3'  'CDRF1'   'CHLV2'\
              'CLKN7'   'CSBF1'   'DBLN6'   'DESW1'   'DISW3'  'DPIA1'  'DRFA2'   'DRYF1'\
              'DSLN7'   'DUCN7'   'EB01 '   'EB10 '   'EB31 '  'EB32 '  'EB33 '   'EB35' \
              'EB36 '   'EB43 '   'EB52 '   'EB53 '   'EB61 '  'EB62 '  'EB70 '   'EB90' \
              'EB91 '   'EB92 '   'FARP2'   'FBIS1'   'FFIA2'  'FILA2'  'FPSN7'   'FWYF1'\
              'GBCL1'   'GDIL1'   'GLLN6'   'IOSN3'   'KTNF1'  'LNEL1'  'LONF1'   'LPOI1'\
              'MDRM1'   'MISM1'   'MLRF1'   'MPCL1'   'MRKA2'  'NWPO3'  'PILA2'   'PILM4'\
              'PLSF1'   'POTA2'   'PTAC1'   'PTAT2'   'PTGC1'  'ROAM4'  'SANF1'   'SAUF1'\ 
              'SBIO1'   'SGNW3'   'SGOF1'   'SISW1'   'SJLF1'  'SMKF1'  'SPGF1'   'SRST2'\ 
              'STDM4'   'SUPN6'   'SVLS1'   'THIN6'   'TPLM2'  'TTIW1'  'VENF1'   'WPOW1' )

echo "StationID,Longitude,Latitude" > ndbc_stations.txt

for ST in ${stationList[@]}
do
    echo $ST
    wget -O station.txt "https://www.ndbc.noaa.gov/station_page.php?station=$ST" -o log.txt

    datline=$(cat station.txt | grep "radial_search")
    dat2=$(echo $datline | cut -d? -f2)
    latns=$(echo $dat2 | cut -d\= -f2 | cut -d\& -f1)
    lonew=$(echo $dat2 | cut -d\= -f3 | cut -d\& -f1)

    lat=$(echo $latns | rev | cut -c2- | rev)
    lon=$(echo $lonew | rev | cut -c2- | rev)
    ew=$(echo $lonew | rev | cut -c1)
    ns=$(echo $latns | rev | cut -c1)

    if [ "x$ew" == "x" ]; then
        echo ERROR: $ST
        echo ERROR: $ST >> error_log.txt
        continue;
    fi

    if [ $ew == 'W' ] ; then
        lon=-$lon
    fi

    if [ $ns == 'S' ] ; then
        lat=-$lat
    fi

    echo "$ST,$lon,$lat" >> ndbc_stations.txt

    rm station.txt log.txt

done
